<!doctype html>

<html class="no-js" lang="{{ request.locale.iso_code }}" dir="{% render 'direction' %}">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, height=device-height, minimum-scale=1.0, maximum-scale=1.0">
    <meta name="theme-color" content="{{ settings.header_background }}">

    <title>{% if page_title == blank %}{{ shop.name }}{% else %}{{ page_title }}{% if current_page != 1 %} &ndash; {{ 'general.page' | t: page: current_page }}{% endif %}{% endif %}</title>

    {%- if page_description -%}
      <meta name="description" content="{{ page_description | escape }}">
    {%- endif -%}

    <link rel="canonical" href="{{ canonical_url }}">

    {%- if settings.favicon -%}
      <link rel="shortcut icon" href="{{ settings.favicon | image_url: width: 96 }}">
      <link rel="apple-touch-icon" href="{{ settings.favicon | image_url: width: 180 }}">
    {%- endif -%}

    {%- comment -%}Few prefetch to increase performance on commonly used third-parties{%- endcomment -%}
    <link rel="preconnect" href="https://cdn.shopify.com">
    <link rel="preconnect" href="https://fonts.shopifycdn.com" crossorigin>
    <link rel="dns-prefetch" href="https://productreviews.shopifycdn.com">

    {%- unless settings.heading_font.system? -%}
      <link rel="preload" href="{{ settings.heading_font | font_url }}" as="font" type="font/woff2" crossorigin>
    {%- endunless -%}

    {%- unless settings.text_font.system? -%}
      <link rel="preload" href="{{ settings.text_font | font_url }}" as="font" type="font/woff2" crossorigin>
    {%- endunless -%}

    {%- render 'social-meta-tags' -%}
    {%- render 'microdata-schema' -%}
    {%- render 'css-variables' -%}
    {%- render 'js-variables' -%}

    <script type="module" src="{{ 'vendor.min.js' | asset_url }}"></script>
    <script type="module" src="{{ 'theme.js' | asset_url }}"></script>
    <script type="module" src="{{ 'sections.js' | asset_url }}"></script>

    {{ content_for_header }}

    {{- 'theme.css' | asset_url | stylesheet_tag: preload: true -}}
  </head>

  <body class="{% if settings.show_page_transition %}page-transition{% endif %} {% if settings.zoom_image_on_hover %}zoom-image--enabled{% endif %}">
    {%- render 'shadow-dom-templates' -%}

    <a href="#main" class="skip-to-content sr-only">{{ 'general.accessibility.skip_to_content' | t }}</a>

    {%- if request.page_type != 'password' -%}
      {%- sections 'header-group' -%}
      {%- sections 'overlay-group' -%}

      {%- if settings.cart_type == 'popover' -%}
        <cart-notification-drawer open-from="bottom" class="quick-buy-drawer drawer"></cart-notification-drawer>
      {%- endif -%}
    {%- endif -%}

    {%- if request.page_type == 'customers/account' or request.page_type == 'customers/order' or request.page_type == 'customers/addresses' -%}
      {%- section 'account-banner' -%}
    {%- endif -%}

    <main role="main" id="main" class="anchor">
      {{ content_for_layout }}

      {%- comment -%}
      IMPLEMENTATION NOTE: due to the very complex logic of margin/padding collapsing, the footer group is
      added into the main element to ensure that dynamic sections added into the footer group are properly laid out.
      {%- endcomment -%}
      {%- if request.page_type != 'password' -%}
        {%- sections 'footer-group' -%}
      {%- endif -%}
    </main>   

    <script>
// =============== Retigena Perf Booster ===============

// 1. Forcer lazy-loading sur toutes les images et iframes
document.addEventListener("DOMContentLoaded", function() {
  document.querySelectorAll("img, iframe").forEach(el => {
    if (!el.hasAttribute("loading")) {
      el.setAttribute("loading", "lazy");
    }
    // Bonus: forcer async decoding
    el.setAttribute("decoding", "async");
  });
});

// 2. Différer le chargement des scripts lourds (Google Analytics, widgets...)
window.addEventListener("load", function() {
  setTimeout(function(){

    // ========== Google Analytics 4 ==========
    var ga = document.createElement('script');
    ga.src = "https://www.googletagmanager.com/gtag/js?id=G-MCN053PRH1";
    ga.async = true; ga.defer = true;
    document.body.appendChild(ga);

    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-MCN053PRH1');

    // ========== Exemple: Autre widget (chat, heatmap, popup) ==========
    // var widget = document.createElement('script');
    // widget.src = "https://cdn.vendor.com/widget.js";
    // widget.async = true; widget.defer = true;
    // document.body.appendChild(widget);

  }, 2000); // Lance après 2 secondes
});

// 3. Précharger les ressources critiques (CSS & JS du thème)
var preloads = [
  { href: "{{ 'theme.css' | asset_url }}", as: "style" },
  { href: "{{ 'theme.js' | asset_url }}", as: "script" }
];
preloads.forEach(function(file) {
  var link = document.createElement('link');
  link.rel = 'preload';
  link.href = file.href;
  link.as = file.as;
  document.head.appendChild(link);
});

// =====================================================
</script>

<style id="retigena-loox-hard-override">
  /* Actif uniquement sur le produit 1082 (classe ajoutée par le JS ci-dessous) */
  .retigena-p1082 #header .summary button div > span,
  .retigena-p1082 .summary button div > span {
    /* On cache visuellement le texte natif (ex: 39) et on le remplace via ::after */
    font-size: 0 !important;
    line-height: 1 !important;
    visibility: visible !important;
  }
  .retigena-p1082 #header .summary button div > span::after,
  .retigena-p1082 .summary button div > span::after {
    content: "1080 avis";
    font-size: 0.95em;         /* taille réelle du texte */
    margin-left: 6px;
  }

  /* En plus, on neutralise les sélecteurs Loox classiques, au cas où */
  .retigena-p1082 .loox-rating .loox-rating__amount,
  .retigena-p1082 .loox-rating__amount {
    font-size: 0 !important;
    line-height: 1 !important;
  }
  .retigena-p1082 .loox-rating .loox-rating__amount::after,
  .retigena-p1082 .loox-rating__amount::after {
    content: "1080 avis";
    font-size: 0.95em;
    margin-left: 6px;
  }
</style>

<script>
/* Retigena — Verrouiller le compteur à 1080 avis sur le produit 1082 */
document.addEventListener('DOMContentLoaded', function () {
  // 1) Vérifier l’ID produit via la meta OG (change "1082" si besoin)
  var metaId = document.querySelector('meta[property="og:product_id"]');
  if (!metaId || metaId.content !== '1082') return;

  // 2) Marquer la page pour activer le CSS ciblé
  document.documentElement.classList.add('retigena-p1082');

  // 3) Filet de sécurité JS : si Loox/Thème réécrit le nœud, on reforce le texte
  function forceCount() {
    // Chemin que tu as donné
    var el = document.querySelector('#header > div.summary > button > div > span');
    if (!el) {
      // versions responsive / variantes de structure
      el = document.querySelector('.summary button div > span') ||
           document.querySelector('.loox-rating__amount') ||
           document.querySelector('.loox-rating .loox-rating__amount');
    }
    if (el) {
      // Certains thèmes encapsulent dans un <span> sans classe : on remplace le texte brut
      if (!/1080\s*avis/i.test(el.textContent)) el.textContent = '1080 avis';
    }
  }

  // Premier passage
  forceCount();

  // Observer tous les changements du DOM (Loox ré-injecte souvent)
  var mo = new MutationObserver(forceCount);
  mo.observe(document.body, { childList: true, subtree: true });

  // Impulsion périodique pendant les 10 premières secondes (ultra safe)
  var t0 = Date.now();
  var iv = setInterval(function(){
    forceCount();
    if (Date.now() - t0 > 10000) clearInterval(iv);
  }, 500);
});
</script>






  </body>
</html>